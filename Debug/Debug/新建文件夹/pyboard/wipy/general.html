

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>General information about the WiPy &mdash; MicroPython 1.9.2 文档</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/customstyle.css" type="text/css" />
  

  
        <link rel="index" title="索引"
              href="../genindex.html"/>
        <link rel="search" title="搜索" href="../search.html"/>
    <link rel="top" title="MicroPython 1.9.2 文档" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MicroPython
          

          
            
            <img src="../_static/singtown.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../pyboard/quickref.html">pyboard快速参考</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyboard/general.html">pyboard基本信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyboard/tutorial/index.html">pyboard的MicroPython教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library/index.html">MicroPython 函数库</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">MicroPython语言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genrst/index.html">MicroPython 与 CPython 的不同</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MicroPython 许可证信息</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MicroPython</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>General information about the WiPy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/wipy/general.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="general-information-about-the-wipy">
<h1>General information about the WiPy<a class="headerlink" href="#general-information-about-the-wipy" title="永久链接至标题">¶</a></h1>
<div class="section" id="no-floating-point-support">
<h2>No floating point support<a class="headerlink" href="#no-floating-point-support" title="永久链接至标题">¶</a></h2>
<p>Due to space reasons, there’s no floating point support, and no math module. This
means that floating point numbers cannot be used anywhere in the code, and that
all divisions must be performed using ‘//’ instead of ‘/’. Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># this will work</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">2</span>   <span class="c1"># this WON&#39;T</span>
</pre></div>
</div>
</div>
<div class="section" id="before-applying-power">
<h2>Before applying power<a class="headerlink" href="#before-applying-power" title="永久链接至标题">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">The GPIO pins of the WiPy are NOT 5V tolerant, connecting them to voltages higher
than 3.6V will cause irreparable damage to the board. ADC pins, when configured
in analog mode cannot withstand voltages above 1.8V. Keep these considerations in
mind when wiring your electronics.</p>
</div>
</div>
<div class="section" id="wlan-default-behaviour">
<h2>WLAN default behaviour<a class="headerlink" href="#wlan-default-behaviour" title="永久链接至标题">¶</a></h2>
<p>When the WiPy boots with the default factory configuration starts in Access Point
mode with <code class="docutils literal"><span class="pre">ssid</span></code> that starts with: <code class="docutils literal"><span class="pre">wipy-wlan</span></code> and <code class="docutils literal"><span class="pre">key:</span> <span class="pre">www.wipy.io</span></code>.
Connect to this network and the WiPy will be reachable at <code class="docutils literal"><span class="pre">192.168.1.1</span></code>. In order
to gain access to the interactive prompt, open a telnet session to that IP address on
the default port (23). You will be asked for credentials:
<code class="docutils literal"><span class="pre">login:</span> <span class="pre">micro</span></code> and <code class="docutils literal"><span class="pre">password:</span> <span class="pre">python</span></code></p>
</div>
<div class="section" id="telnet-repl">
<span id="wipy-telnet"></span><h2>Telnet REPL<a class="headerlink" href="#telnet-repl" title="永久链接至标题">¶</a></h2>
<p>Linux stock telnet works like a charm (also on OSX), but other tools like putty
work quite well too. The default credentials are: <strong>user:</strong> <code class="docutils literal"><span class="pre">micro</span></code>, <strong>password:</strong> <code class="docutils literal"><span class="pre">python</span></code>.
See <span class="xref std std-ref">network.server</span> for info on how to change the defaults.
For instance, on a linux shell (when connected to the WiPy in AP mode):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ telnet 192.168.1.1
</pre></div>
</div>
</div>
<div class="section" id="local-file-system-and-ftp-access">
<span id="wipy-filesystem"></span><h2>Local file system and FTP access<a class="headerlink" href="#local-file-system-and-ftp-access" title="永久链接至标题">¶</a></h2>
<p>There is a small internal file system (a drive) on the WiPy, called <code class="docutils literal"><span class="pre">/flash</span></code>,
which is stored within the external serial flash memory.  If a micro SD card
is hooked-up and mounted, it will be available as well.</p>
<p>When the WiPy starts up, it always boots from the <code class="docutils literal"><span class="pre">boot.py</span></code> located in the
<code class="docutils literal"><span class="pre">/flash</span></code> file system. On boot up, the current directory is <code class="docutils literal"><span class="pre">/flash</span></code>.</p>
<p>The file system is accessible via the native FTP server running in the WiPy.
Open your FTP client of choice and connect to:</p>
<p><strong>url:</strong> <code class="docutils literal"><span class="pre">ftp://192.168.1.1</span></code>, <strong>user:</strong> <code class="docutils literal"><span class="pre">micro</span></code>, <strong>password:</strong> <code class="docutils literal"><span class="pre">python</span></code></p>
<p>See <span class="xref std std-ref">network.server</span> for info on how to change the defaults.
The recommended clients are: Linux stock FTP (also in OSX), Filezilla and FireFTP.
For example, on a linux shell:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ ftp 192.168.1.1
</pre></div>
</div>
<p>The FTP server on the WiPy doesn’t support active mode, only passive, therefore,
if using the native unix ftp client, just after logging in do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ftp</span><span class="o">&gt;</span> <span class="n">passive</span>
</pre></div>
</div>
<p>Besides that, the FTP server only supports one data connection at a time. Check out
the Filezilla settings section below for more info.</p>
</div>
<div class="section" id="filezilla-settings">
<h2>FileZilla settings<a class="headerlink" href="#filezilla-settings" title="永久链接至标题">¶</a></h2>
<p>Do not use the quick connect button, instead, open the site manager and create a new
configuration. In the <code class="docutils literal"><span class="pre">General</span></code> tab make sure that encryption is set to: <code class="docutils literal"><span class="pre">Only</span> <span class="pre">use</span>
<span class="pre">plain</span> <span class="pre">FTP</span> <span class="pre">(insecure)</span></code>. In the Transfer Settings tab limit the max number of connections
to one, otherwise FileZilla will try to open a second command connection when retrieving
and saving files, and for simplicity and to reduce code size, only one command and one
data connections are possible. Other FTP clients might behave in a similar way.</p>
</div>
<div class="section" id="upgrading-the-firmware-over-the-air">
<span id="wipy-firmware-upgrade"></span><h2>Upgrading the firmware Over The Air<a class="headerlink" href="#upgrading-the-firmware-over-the-air" title="永久链接至标题">¶</a></h2>
<p>OTA software updates can be performed through the FTP server. Upload the <code class="docutils literal"><span class="pre">mcuimg.bin</span></code> file
to: <code class="docutils literal"><span class="pre">/flash/sys/mcuimg.bin</span></code> it will take around 6s. You won’t see the file being stored
inside <code class="docutils literal"><span class="pre">/flash/sys/</span></code> because it’s actually saved bypassing the user file system, so it
ends up inside the internal <strong>hidden</strong> file system, but rest assured that it was successfully
transferred, and it has been signed with a MD5 checksum to verify its integrity. Now, reset
the WiPy by pressing the switch on the board, or by typing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">machine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">machine</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
<p>Software updates can be found in: <a class="reference external" href="https://github.com/wipy/wipy/releases">https://github.com/wipy/wipy/releases</a> (<strong>Binaries.zip</strong>).
It’s always recommended to update to the latest software, but make sure to
read the <strong>release notes</strong> before.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The <code class="docutils literal"><span class="pre">bootloader.bin</span></code> found inside <code class="docutils literal"><span class="pre">Binaries.zip</span></code> is there only for reference, it’s not
needed for the Over The Air update.</p>
</div>
<p>In order to check your software version, do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">uname</span><span class="p">()</span><span class="o">.</span><span class="n">release</span>
</pre></div>
</div>
<p>If the version number is lower than the latest release found in
<a class="reference external" href="https://github.com/wipy/wipy/releases">the releases</a>, go ahead and update your WiPy!</p>
</div>
<div class="section" id="boot-modes-and-safe-boot">
<span id="wipy-boot-modes"></span><h2>Boot modes and safe boot<a class="headerlink" href="#boot-modes-and-safe-boot" title="永久链接至标题">¶</a></h2>
<p>If you power up normally, or press the reset button, the WiPy will boot
into standard mode; the <code class="docutils literal"><span class="pre">boot.py</span></code> file will be executed first, then
<code class="docutils literal"><span class="pre">main.py</span></code> will run.</p>
<p>You can override this boot sequence by pulling <code class="docutils literal"><span class="pre">GP28</span></code> <strong>up</strong> (connect
it to the 3v3 output pin) during reset. This procedure also allows going
back in time to old firmware versions. The WiPy can hold up to 3 different
firmware versions, which are: the factory firmware plus 2 user updates.</p>
<p>After reset, if <code class="docutils literal"><span class="pre">GP28</span></code> is held high, the heartbeat LED will start flashing
slowly, if after 3 seconds the pin is still being held high, the LED will start
blinking a bit faster and the WiPy will select the previous user update to boot.
If the previous user update is the desired firmware image, <code class="docutils literal"><span class="pre">GP28</span></code> must be
released before 3 more seconds elapse. If 3 seconds later the pin is still high,
the factory firmware will be selected, the LED will flash quickly for 1.5 seconds
and the WiPy will proceed to boot. The firmware selection mechanism is as follows:</p>
<p><strong>Safe Boot Pin</strong> <code class="docutils literal"><span class="pre">GP28</span></code> <strong>released during:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="32%" />
<col width="36%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">1st 3 secs window</th>
<th class="head">2nd 3 secs window</th>
<th class="head">Final 1.5 secs window</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Safe boot, <em>latest</em></div>
<div class="line">firmware is selected</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Safe boot, <em>previous</em></div>
<div class="line">user update selected</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Safe boot, the <em>factory</em></div>
<div class="line">firmware is selected</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>On all of the above 3 scenarios, safe boot mode is entered, meaning that
the execution of both <code class="docutils literal"><span class="pre">boot.py</span></code> and <code class="docutils literal"><span class="pre">main.py</span></code> is skipped. This is
useful to recover from crash situations caused by the user scripts. The selection
made during safe boot is not persistent, therefore after the next normal reset
the latest firmware will run again.</p>
</div>
<div class="section" id="the-heartbeat-led">
<h2>The heartbeat LED<a class="headerlink" href="#the-heartbeat-led" title="永久链接至标题">¶</a></h2>
<p>By default the heartbeat LED flashes once every 4s to signal that the system is
alive. This can be overridden through the <code class="xref py py-mod docutils literal"><span class="pre">wipy</span></code> module:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wipy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wipy</span><span class="o">.</span><span class="n">heartbeat</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>There are currently 2 kinds of errors that you might see:</p>
<ol class="arabic simple">
<li>If the heartbeat LED flashes quickly, then a Python script (eg <code class="docutils literal"><span class="pre">main.py</span></code>)
has an error.  Use the REPL to debug it.</li>
<li>If the heartbeat LED stays on, then there was a hard fault, you cannot
recover from this, the only way out is to press the reset switch.</li>
</ol>
</div>
<div class="section" id="details-on-sleep-modes">
<h2>Details on sleep modes<a class="headerlink" href="#details-on-sleep-modes" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">machine.idle()</span></code>: Power consumption: ~12mA (in WLAN STA mode). Wake sources:
any hardware interrupt (including systick with period of 1ms), no special
configuration required.</li>
<li><code class="docutils literal"><span class="pre">machine.sleep()</span></code>: 950uA (in WLAN STA mode). Wake sources are <code class="docutils literal"><span class="pre">Pin</span></code>, <code class="docutils literal"><span class="pre">RTC</span></code>
and <code class="docutils literal"><span class="pre">WLAN</span></code></li>
<li><code class="docutils literal"><span class="pre">machine.deepsleep()</span></code>: ~350uA. Wake sources are <code class="docutils literal"><span class="pre">Pin</span></code> and <code class="docutils literal"><span class="pre">RTC</span></code>.</li>
</ul>
</div>
<div class="section" id="additional-details-for-machine-pin">
<h2>Additional details for machine.Pin<a class="headerlink" href="#additional-details-for-machine-pin" title="永久链接至标题">¶</a></h2>
<p>On the WiPy board the pins are identified by their string id:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="s1">&#39;GP9&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">,</span> <span class="n">pull</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drive</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">MED_POWER</span><span class="p">,</span> <span class="n">alt</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also configure the Pin to generate interrupts. For instance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span>

<span class="k">def</span> <span class="nf">pincb</span><span class="p">(</span><span class="n">pin</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pin</span><span class="o">.</span><span class="n">id</span><span class="p">())</span>

<span class="n">pin_int</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="s1">&#39;GP10&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">pull</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">PULL_DOWN</span><span class="p">)</span>
<span class="n">pin_int</span><span class="o">.</span><span class="n">irq</span><span class="p">(</span><span class="n">trigger</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">IRQ_RISING</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="n">pincb</span><span class="p">)</span>
<span class="c1"># the callback can be triggered manually</span>
<span class="n">pin_int</span><span class="o">.</span><span class="n">irq</span><span class="p">()()</span>
<span class="c1"># to disable the callback</span>
<span class="n">pin_int</span><span class="o">.</span><span class="n">irq</span><span class="p">()</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
</pre></div>
</div>
<p>Now every time a falling edge is seen on the gpio pin, the callback will be
executed. Caution: mechanical push buttons have “bounce” and pushing or
releasing a switch will often generate multiple edges.
See: <a class="reference external" href="http://www.eng.utah.edu/~cs5780/debouncing.pdf">http://www.eng.utah.edu/~cs5780/debouncing.pdf</a> for a detailed
explanation, along with various techniques for debouncing.</p>
<p>All pin objects go through the pin mapper to come up with one of the
gpio pins.</p>
<p>For the <code class="docutils literal"><span class="pre">drive</span></code> parameter the strengths are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">Pin.LOW_POWER</span></code> - 2mA drive capability.</li>
<li><code class="docutils literal"><span class="pre">Pin.MED_POWER</span></code> - 4mA drive capability.</li>
<li><code class="docutils literal"><span class="pre">Pin.HIGH_POWER</span></code> - 6mA drive capability.</li>
</ul>
</div></blockquote>
<p>For the <code class="docutils literal"><span class="pre">alt</span></code> parameter please refer to the pinout and alternate functions
table at &lt;<a class="reference external" href="https://raw.githubusercontent.com/wipy/wipy/master/docs/PinOUT.png">https://raw.githubusercontent.com/wipy/wipy/master/docs/PinOUT.png</a>&gt;`_
for the specific alternate functions that each pin supports.</p>
<p>For interrupts, the <code class="docutils literal"><span class="pre">priority</span></code> can take values in the range 1-7.  And the
<code class="docutils literal"><span class="pre">wake</span></code> parameter has the following properties:</p>
<blockquote>
<div><ul class="simple">
<li>If <code class="docutils literal"><span class="pre">wake_from=machine.Sleep.ACTIVE</span></code> any pin can wake the board.</li>
<li>If <code class="docutils literal"><span class="pre">wake_from=machine.Sleep.SUSPENDED</span></code> pins <code class="docutils literal"><span class="pre">GP2</span></code>, <code class="docutils literal"><span class="pre">GP4</span></code>, <code class="docutils literal"><span class="pre">GP10</span></code>,
<code class="docutils literal"><span class="pre">GP11</span></code>, GP17`` or <code class="docutils literal"><span class="pre">GP24</span></code> can wake the board. Note that only 1
of this pins can be enabled as a wake source at the same time, so, only
the last enabled pin as a <code class="docutils literal"><span class="pre">machine.Sleep.SUSPENDED</span></code> wake source will have effect.</li>
<li>If <code class="docutils literal"><span class="pre">wake_from=machine.Sleep.SUSPENDED</span></code> pins <code class="docutils literal"><span class="pre">GP2</span></code>, <code class="docutils literal"><span class="pre">GP4</span></code>, <code class="docutils literal"><span class="pre">GP10</span></code>,
<code class="docutils literal"><span class="pre">GP11</span></code>, <code class="docutils literal"><span class="pre">GP17</span></code> and <code class="docutils literal"><span class="pre">GP24</span></code> can wake the board. In this case all of the
6 pins can be enabled as a <code class="docutils literal"><span class="pre">machine.Sleep.HIBERNATE</span></code> wake source at the same time.</li>
</ul>
</div></blockquote>
<p>Additional Pin methods:</p>
<dl class="method">
<dt id="machine.Pin.alt_list">
<code class="descclassname">machine.Pin.</code><code class="descname">alt_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.Pin.alt_list" title="永久链接至目标">¶</a></dt>
<dd><p>Returns a list of the alternate functions supported by the pin. List items are
a tuple of the form: <code class="docutils literal"><span class="pre">('ALT_FUN_NAME',</span> <span class="pre">ALT_FUN_INDEX)</span></code></p>
</dd></dl>

</div>
<div class="section" id="additional-details-for-machine-i2c">
<h2>Additional details for machine.I2C<a class="headerlink" href="#additional-details-for-machine-i2c" title="永久链接至标题">¶</a></h2>
<p>On the WiPy there is a single hardware I2C peripheral, identified by “0”.  By
default this is the peripheral that is used when constructing an I2C instance.
The default pins are GP23 for SCL and GP13 for SDA, and one can create the
default I2C peripheral simply by doing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">i2c</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">I2C</span><span class="p">()</span>
</pre></div>
</div>
<p>The pins and frequency can be specified as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">i2c</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">I2C</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">400000</span><span class="p">,</span> <span class="n">scl</span><span class="o">=</span><span class="s1">&#39;GP23&#39;</span><span class="p">,</span> <span class="n">sda</span><span class="o">=</span><span class="s1">&#39;GP13&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Only certain pins can be used as SCL/SDA.  Please refer to the pinout for further
information.</p>
</div>
<div class="section" id="known-issues">
<h2>Known issues<a class="headerlink" href="#known-issues" title="永久链接至标题">¶</a></h2>
<div class="section" id="incompatible-way-to-create-ssl-sockets">
<h3>Incompatible way to create SSL sockets<a class="headerlink" href="#incompatible-way-to-create-ssl-sockets" title="永久链接至标题">¶</a></h3>
<p>SSL sockets need to be created the following way before wrapping them with.
<code class="docutils literal"><span class="pre">ssl.wrap_socket</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">ssl</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">IPPROTO_SEC</span><span class="p">)</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>Certificates must be used in order to validate the other side of the connection, and also to
authenticate ourselves with the other end. Such certificates must be stored as files using the
FTP server, and they must be placed in specific paths with specific names.</p>
<ul class="simple">
<li>The certificate to validate the other side goes in: <strong>‘/flash/cert/ca.pem’</strong></li>
<li>The certificate to authenticate ourselves goes in: <strong>‘/flash/cert/cert.pem’</strong></li>
<li>The key for our own certificate goes in: <strong>‘/flash/cert/private.key’</strong></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">When these files are stored, they are placed inside the internal <strong>hidden</strong> file system
(just like firmware updates), and therefore they are never visible.</p>
</div>
<p>For instance to connect to the Blynk servers using certificates, take the file <code class="docutils literal"><span class="pre">ca.pem</span></code> located
in the <a class="reference external" href="https://github.com/wipy/wipy/tree/master/examples/blynk">blynk examples folder</a>.
and put it in ‘/flash/cert/’. Then do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">ssl</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">IPPROTO_SEC</span><span class="p">)</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">cert_reqs</span><span class="o">=</span><span class="n">ssl</span><span class="o">.</span><span class="n">CERT_REQUIRED</span><span class="p">,</span> <span class="n">ca_certs</span><span class="o">=</span><span class="s1">&#39;/flash/cert/ca.pem&#39;</span><span class="p">)</span>
<span class="n">ss</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">getaddrinfo</span><span class="p">(</span><span class="s1">&#39;cloud.blynk.cc&#39;</span><span class="p">,</span> <span class="mi">8441</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="incompatibilities-in-uhashlib-module">
<h3>Incompatibilities in uhashlib module<a class="headerlink" href="#incompatibilities-in-uhashlib-module" title="永久链接至标题">¶</a></h3>
<p>Due to hardware implementation details of the WiPy, data must be buffered before being
digested, which would make it impossible to calculate the hash of big blocks of data that
do not fit in RAM. In this case, since most likely the total size of the data is known
in advance, the size can be passed to the constructor and hence the HASH hardware engine
of the WiPy can be properly initialized without needing buffering. If <code class="docutils literal"><span class="pre">block_size</span></code> is
to be given, an initial chunk of <code class="docutils literal"><span class="pre">data</span></code> must be passed as well. <strong>When using this extension,
care must be taken to make sure that the length of all intermediate chunks (including the
initial one) is a multiple of 4 bytes.</strong> The last chunk may be of any length.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">hash</span> <span class="o">=</span> <span class="n">uhashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="s1">&#39;abcd1234&#39;</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>    <span class="c1"># length of the initial piece is multiple of 4 bytes</span>
<span class="nb">hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;1234&#39;</span><span class="p">)</span>                       <span class="c1"># also multiple of 4 bytes</span>
<span class="o">...</span>
<span class="nb">hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;12345&#39;</span><span class="p">)</span>                      <span class="c1"># last chunk may be of any length</span>
<span class="nb">hash</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="unrelated-function-in-machine-module">
<h3>Unrelated function in machine module<a class="headerlink" href="#unrelated-function-in-machine-module" title="永久链接至标题">¶</a></h3>
<dl class="function">
<dt id="main">
<code class="descname">main</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#main" title="永久链接至目标">¶</a></dt>
<dd><p>Set the filename of the main script to run after boot.py is finished.  If
this function is not called then the default file main.py will be executed.</p>
<p>It only makes sense to call this function from within boot.py.</p>
</dd></dl>

</div>
<div class="section" id="adhoc-way-to-control-telnet-ftp-server-via-network-module">
<h3>Adhoc way to control telnet/FTP server via network module<a class="headerlink" href="#adhoc-way-to-control-telnet-ftp-server-via-network-module" title="永久链接至标题">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Server</span></code> class controls the behaviour and the configuration of the FTP and telnet
services running on the WiPy. Any changes performed using this class’ methods will
affect both.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">network</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">Server</span><span class="p">()</span>
<span class="n">server</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span> <span class="c1"># disable the server</span>
<span class="c1"># enable the server again with new settings</span>
<span class="n">server</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">login</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="network.Server">
<em class="property">class </em><code class="descclassname">network.</code><code class="descname">Server</code><span class="sig-paren">(</span><em>id</em>, <em>...</em><span class="sig-paren">)</span><a class="headerlink" href="#network.Server" title="永久链接至目标">¶</a></dt>
<dd><p>Create a server instance, see <code class="docutils literal"><span class="pre">init</span></code> for parameters of initialization.</p>
</dd></dl>

<dl class="method">
<dt id="server.init">
<code class="descclassname">server.</code><code class="descname">init</code><span class="sig-paren">(</span><em>*</em>, <em>login=('micro'</em>, <em>'python')</em>, <em>timeout=300</em><span class="sig-paren">)</span><a class="headerlink" href="#server.init" title="永久链接至目标">¶</a></dt>
<dd><p>Init (and effectively start the server). Optionally a new <code class="docutils literal"><span class="pre">user</span></code>, <code class="docutils literal"><span class="pre">password</span></code>
and <code class="docutils literal"><span class="pre">timeout</span></code> (in seconds) can be passed.</p>
</dd></dl>

<dl class="method">
<dt id="server.deinit">
<code class="descclassname">server.</code><code class="descname">deinit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#server.deinit" title="永久链接至目标">¶</a></dt>
<dd><p>Stop the server</p>
</dd></dl>

<dl class="method">
<dt id="server.timeout">
<code class="descclassname">server.</code><code class="descname">timeout</code><span class="sig-paren">(</span><span class="optional">[</span><em>timeout_in_seconds</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#server.timeout" title="永久链接至目标">¶</a></dt>
<dd><p>Get or set the server timeout.</p>
</dd></dl>

<dl class="method">
<dt id="server.isrunning">
<code class="descclassname">server.</code><code class="descname">isrunning</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#server.isrunning" title="永久链接至目标">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the server is running, <code class="docutils literal"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>

</div>
<div class="section" id="adhoc-vfs-like-support">
<h3>Adhoc VFS-like support<a class="headerlink" href="#adhoc-vfs-like-support" title="永久链接至标题">¶</a></h3>
<p>WiPy doesn’t implement full MicroPython VFS support, instead following
functions are defined in <code class="docutils literal"><span class="pre">uos</span></code> module:</p>
<dl class="function">
<dt id="mount">
<code class="descname">mount</code><span class="sig-paren">(</span><em>block_device</em>, <em>mount_point</em>, <em>*</em>, <em>readonly=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mount" title="永久链接至目标">¶</a></dt>
<dd><p>Mounts a block device (like an <code class="docutils literal"><span class="pre">SD</span></code> object) in the specified mount
point. Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="s1">&#39;/sd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="unmount">
<code class="descname">unmount</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#unmount" title="永久链接至目标">¶</a></dt>
<dd><p>Unmounts a previously mounted block device from the given path.</p>
</dd></dl>

<dl class="function">
<dt id="mkfs">
<code class="descname">mkfs</code><span class="sig-paren">(</span><em>block_device or path</em><span class="sig-paren">)</span><a class="headerlink" href="#mkfs" title="永久链接至目标">¶</a></dt>
<dd><p>Formats the specified path, must be either <code class="docutils literal"><span class="pre">/flash</span></code> or <code class="docutils literal"><span class="pre">/sd</span></code>.
A block device can also be passed like an <code class="docutils literal"><span class="pre">SD</span></code> object before
being mounted.</p>
</dd></dl>

</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2017, Damien P. George, Paul Sokolovsky, 星瞳科技SingTown, and contributors.
      最后更新于 17 3月 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Ports and Versions</span>
    pyboard (latest)
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Ports</dt>
      
        <dd><a href="https://docs.singtown.com/micropython/zh/latest/pyboard/index.html">pyboard</a></dd>
      
        <dd><a href="https://docs.singtown.com/micropython/zh/latest/esp32/index.html">esp32</a></dd>
      
        <dd><a href="https://docs.singtown.com/micropython/zh/latest/openmvcam/index.html">openmvcam</a></dd>
      
    </dl>
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="https://docs.singtown.com/micropython/zh/latest/pyboard/index.html">latest</a></dd>
      
    </dl>
    <dl>
        <dt>Language</dt>
        
          <dd><a href="https://docs.micropython.org/en/latest/pyboard">English</a></dd>
        
          <dd><a href="https://docs.singtown.com/micropython/zh/latest/pyboard/index.html">中文</a></dd>
        
    </dl>

    <dl>
    </dl>
    <hr/>
    <dl>
      <dt>External links</dt>
        <dd>
          <a href="https://kaizhi-xu.taobao.com">立即购买 OpenMV Cam</a>
        </dd>
    </dl>
  </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.9.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
