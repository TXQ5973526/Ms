

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>utime – 时间相关的函数 &mdash; MicroPython 1.9.2 文档</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/customstyle.css" type="text/css" />
  

  
        <link rel="index" title="索引"
              href="../genindex.html"/>
        <link rel="search" title="搜索" href="../search.html"/>
    <link rel="top" title="MicroPython 1.9.2 文档" href="../index.html"/>
        <link rel="up" title="MicroPython 函数库" href="index.html"/>
        <link rel="next" title="uzlib – zlib解压缩" href="uzlib.html"/>
        <link rel="prev" title="ustruct – 打包和解压缩原始数据类型" href="ustruct.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MicroPython
          

          
            
            <img src="../_static/singtown.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pyboard/quickref.html">pyboard快速参考</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyboard/general.html">pyboard基本信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyboard/tutorial/index.html">pyboard的MicroPython教程</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">MicroPython 函数库</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#pythonmicro-libraries">Python标准库和micro-libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="builtins.html">内置函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="array.html"><code class="docutils literal"><span class="pre">array</span></code> – 数组</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmath.html"><code class="docutils literal"><span class="pre">cmath</span></code> – 复数的数学函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="gc.html"><code class="docutils literal"><span class="pre">gc</span></code> – 控制垃圾回收器</a></li>
<li class="toctree-l3"><a class="reference internal" href="math.html"><code class="docutils literal"><span class="pre">math</span></code> – 数学函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="sys.html"><code class="docutils literal"><span class="pre">sys</span></code> – 系统相关函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubinascii.html"><code class="docutils literal"><span class="pre">ubinascii</span></code> – 二进制/ASCII转换</a></li>
<li class="toctree-l3"><a class="reference internal" href="ucollections.html"><code class="docutils literal"><span class="pre">ucollections</span></code> – 容器</a></li>
<li class="toctree-l3"><a class="reference internal" href="uerrno.html"><code class="docutils literal"><span class="pre">uerrno</span></code> – 系统错误代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="uhashlib.html"><code class="docutils literal"><span class="pre">uhashlib</span></code> – 散列算法</a></li>
<li class="toctree-l3"><a class="reference internal" href="uheapq.html"><code class="docutils literal"><span class="pre">uheapq</span></code> – 堆队列算法</a></li>
<li class="toctree-l3"><a class="reference internal" href="uio.html"><code class="docutils literal"><span class="pre">uio</span></code> – 输入/输出流</a></li>
<li class="toctree-l3"><a class="reference internal" href="ujson.html"><code class="docutils literal"><span class="pre">ujson</span></code> – JSON编码与解码</a></li>
<li class="toctree-l3"><a class="reference internal" href="uos.html"><code class="docutils literal"><span class="pre">uos</span></code> – 基本“操作系统”服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="ure.html"><code class="docutils literal"><span class="pre">ure</span></code> – 正则表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="uselect.html"><code class="docutils literal"><span class="pre">uselect</span></code> – 在一组流中等待事件</a></li>
<li class="toctree-l3"><a class="reference internal" href="usocket.html"><code class="docutils literal"><span class="pre">usocket</span></code> – socket模块</a></li>
<li class="toctree-l3"><a class="reference internal" href="ustruct.html"><code class="docutils literal"><span class="pre">ustruct</span></code> – 打包和解压缩原始数据类型</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="docutils literal"><span class="pre">utime</span></code> – 时间相关的函数</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">函数</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="uzlib.html"><code class="docutils literal"><span class="pre">uzlib</span></code> – zlib解压缩</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id2">MicroPython特定的库</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#libraries-specific-to-the-pyboard">Libraries specific to the pyboard</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">MicroPython语言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genrst/index.html">MicroPython 与 CPython 的不同</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MicroPython 许可证信息</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MicroPython</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">MicroPython 函数库</a> &raquo;</li>
        
      <li><code class="docutils literal"><span class="pre">utime</span></code> – 时间相关的函数</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/library/utime.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-utime">
<span id="utime"></span><h1><a class="reference internal" href="#module-utime" title="utime: 时间相关的函数"><code class="xref py py-mod docutils literal"><span class="pre">utime</span></code></a> – 时间相关的函数<a class="headerlink" href="#module-utime" title="永久链接至标题">¶</a></h1>
<p><em>This module implements a subset of the corresponding</em> <a class="reference internal" href="../reference/glossary.html#term-cpython"><code class="xref any std std-term docutils literal"><span class="pre">CPython</span></code></a> <em>module,
as described below. For more information, refer to the original
CPython documentation:</em> <a class="reference external" href="https://docs.python.org/3/library/time.html#module-time" title="(在 Python v3.6)"><code class="docutils literal"><span class="pre">time</span></code></a>.</p>
<p><code class="docutils literal"><span class="pre">utime</span></code> 模块提供用于获取当前时间和日期、测量时间间隔和延迟的函数。</p>
<p><strong>时刻</strong>: Unix端口使用1970-01-01 00:00-00:00 UTC的POSIX系统时间的标准。但是，内嵌端口使用2000-01-01 00:00:00 UTC的时间。</p>
<p><strong>维护实际日历日期/时间</strong>: 这需要实时通信（RTC）。在具备底层OS的系统中，RTC可能是隐式的。设置和维护实际日历时间应是OS/RTOS的职能，
且在MicroPython之外完成，只使用OS API查询日期/时间。在baremetal端口中，系统时间取决于 <code class="docutils literal"><span class="pre">machine.RTC()</span></code> 对象。
当前日历时间可能使用 <code class="docutils literal"><span class="pre">machine.RTC().datetime(tuple)</span></code> 函数来设置，并通过以下方式维护:</p>
<ul class="simple">
<li>由一个备用电池（对于特定板而言，可能是一个额外的可选组件）。</li>
<li>使用网络时间协议（需要通过一个端口/用户安装）。</li>
<li>每次开启电源都进行手动设置（许多板通过硬复位维护RTC时间，尽管有些可能需要在此情况下重新设置）。</li>
</ul>
<p>若实际日历时间未使用系统/MicroPython RTC 维护，需引用当前绝对时间的函数可能与预期不符。</p>
<div class="section" id="id1">
<h2>函数<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<dl class="function">
<dt id="utime.localtime">
<code class="descclassname">utime.</code><code class="descname">localtime</code><span class="sig-paren">(</span><span class="optional">[</span><em>secs</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#utime.localtime" title="永久链接至目标">¶</a></dt>
<dd><p>将一个以秒计的时间转换为一个包含下列内容的8元组：（年、月、日、小时、分钟、秒、一周中某日、一年中某日）。若未提供秒或为None，则使用RTC时间。</p>
<ul class="simple">
<li>年包括世纪（例如2014）</li>
<li>月为 1-12</li>
<li>日为 1-31</li>
<li>小时为 0-23</li>
<li>分钟为 0-59</li>
<li>秒钟 0-59</li>
<li>周中某日为 0-6 （对应周一到周日）</li>
<li>年中某日为 1-366</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="utime.mktime">
<code class="descclassname">utime.</code><code class="descname">mktime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utime.mktime" title="永久链接至目标">¶</a></dt>
<dd><p>此为局部时间的逆函数，其参数为一个表示本地时间的8元组。返回一个表示2000年1月1日以来的秒钟的整数。</p>
</dd></dl>

<dl class="function">
<dt id="utime.sleep">
<code class="descclassname">utime.</code><code class="descname">sleep</code><span class="sig-paren">(</span><em>seconds</em><span class="sig-paren">)</span><a class="headerlink" href="#utime.sleep" title="永久链接至目标">¶</a></dt>
<dd><p>休眠给定秒数的时间。秒钟数可为一个表示休眠时间的浮点数。注意：其他端口可能不接受浮点参数，为满足兼容性，使用 <a class="reference internal" href="#utime.sleep_ms" title="utime.sleep_ms"><code class="xref any py py-func docutils literal"><span class="pre">sleep_ms()</span></code></a> 和 <a class="reference internal" href="#utime.sleep_us" title="utime.sleep_us"><code class="xref any py py-func docutils literal"><span class="pre">sleep_us()</span></code></a> 函数。</p>
</dd></dl>

<dl class="function">
<dt id="utime.sleep_ms">
<code class="descclassname">utime.</code><code class="descname">sleep_ms</code><span class="sig-paren">(</span><em>ms</em><span class="sig-paren">)</span><a class="headerlink" href="#utime.sleep_ms" title="永久链接至目标">¶</a></dt>
<dd><p>延迟给定毫秒数，应为Positive或0。</p>
</dd></dl>

<dl class="function">
<dt id="utime.sleep_us">
<code class="descclassname">utime.</code><code class="descname">sleep_us</code><span class="sig-paren">(</span><em>us</em><span class="sig-paren">)</span><a class="headerlink" href="#utime.sleep_us" title="永久链接至目标">¶</a></dt>
<dd><p>延迟给定的微秒数，应为Positive或0。</p>
</dd></dl>

<dl class="function">
<dt id="utime.ticks_ms">
<code class="descclassname">utime.</code><code class="descname">ticks_ms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utime.ticks_ms" title="永久链接至目标">¶</a></dt>
<dd><p>用在某些值（未指定）后结束后的任意引用点返回一个递增的毫秒计数器。该值应被视为不透明的，且仅适用于ticks_diff()。</p>
<dl class="docutils">
<dt>自动换行值未显式显示，但为简化讨论，我们将其称为 <em>TICKS_MAX</em> 。 该值的周期为  <em>TICKS_PERIOD = TICKS_MAX + 1</em> 。</dt>
<dd><dl class="first last docutils">
<dt><em>TICKS_PERIOD</em>&nbsp;须为2的幂，但也会因端口不同而不同。同一周期值用于 <a class="reference internal" href="#utime.ticks_ms" title="utime.ticks_ms"><code class="xref any py py-func docutils literal"><span class="pre">ticks_ms()</span></code></a> 、 <a class="reference internal" href="#utime.ticks_us" title="utime.ticks_us"><code class="xref any py py-func docutils literal"><span class="pre">ticks_us()</span></code></a> 、</dt>
<dd><a class="reference internal" href="#utime.ticks_cpu" title="utime.ticks_cpu"><code class="xref any py py-func docutils literal"><span class="pre">ticks_cpu()</span></code></a> 函数（为简单起见）。因此，这些函数将返回一个介于 <em>[0&nbsp;..&nbsp;TICKS_MAX]</em> 的值，包括 <em>TICKS_PERIOD</em> 值。</dd>
</dl>
</dd>
</dl>
<p>注意：仅使用非负值。多数情况下，您应将这些函数返回的值视为透明。对之唯一可用的操作为下述的 <a class="reference internal" href="#utime.ticks_diff" title="utime.ticks_diff"><code class="xref any py py-func docutils literal"><span class="pre">ticks_diff()</span></code></a> 和 <a class="reference internal" href="#utime.ticks_add" title="utime.ticks_add"><code class="xref any py py-func docutils literal"><span class="pre">ticks_add()</span></code></a> 函数。</p>
<p>注意：在这些值上直接执行标准的数学操作(+, -)或关系运算符(&lt;, &lt;=, &gt;, &gt;=)将导致无效的结果。
执行数字操作，并将结果作为参数传递给 <code class="docutils literal"><span class="pre">ticks_diff()</span></code> 或 <code class="docutils literal"><span class="pre">ticks_add()</span></code> 将导致后一个函数的无效结果。</p>
</dd></dl>

<dl class="function">
<dt id="utime.ticks_us">
<code class="descclassname">utime.</code><code class="descname">ticks_us</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utime.ticks_us" title="永久链接至目标">¶</a></dt>
<dd><p>正如上述的 <code class="docutils literal"><span class="pre">ticks_ms</span></code> ，但以微秒为单位。</p>
</dd></dl>

<dl class="function">
<dt id="utime.ticks_cpu">
<code class="descclassname">utime.</code><code class="descname">ticks_cpu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utime.ticks_cpu" title="永久链接至目标">¶</a></dt>
<dd><p>与 <code class="docutils literal"><span class="pre">ticks_ms</span></code> 和 <code class="docutils literal"><span class="pre">ticks_us</span></code> 相似，但有更高的分辨率（通常CPU时钟）。</p>
<p>这通常是CPU时钟，这也就是该函数如此命名的原因。但是并非必须为CPU时钟，系统中其他可用的定时源
（例如高分辨率计时器）也可作为替代。该函数确切的定时单元（分辨率）未在 <code class="docutils literal"><span class="pre">utime</span></code> 模块层指定，
但是特定端口的文档可能提供更多具体信息。此函数设计用于非常精细的基准测试或非常紧凑的实时循环。请避免在可移植的程序编码中使用。</p>
<p>可用性：并非每个端口都可以实现该函数。</p>
</dd></dl>

<dl class="function">
<dt id="utime.ticks_add">
<code class="descclassname">utime.</code><code class="descname">ticks_add</code><span class="sig-paren">(</span><em>ticks</em>, <em>delta</em><span class="sig-paren">)</span><a class="headerlink" href="#utime.ticks_add" title="永久链接至目标">¶</a></dt>
<dd><p>用一个给定数字来抵消ticks值，该数字可为正或负。给定一个 <em>ticks</em> 值，该函数允许计算之前或之后的ticks value&nbsp; <em>delta</em> &nbsp;ticks，
并遵循ticks值的模块化算术定义（见上 <a class="reference internal" href="#utime.ticks_ms" title="utime.ticks_ms"><code class="xref any py py-func docutils literal"><span class="pre">ticks_ms()</span></code></a> ）。Ticks参数须为调用 <a class="reference internal" href="#utime.ticks_ms" title="utime.ticks_ms"><code class="xref any py py-func docutils literal"><span class="pre">ticks_ms()</span></code></a> 、 <a class="reference internal" href="#utime.ticks_us" title="utime.ticks_us"><code class="xref any py py-func docutils literal"><span class="pre">ticks_us()</span></code></a> 、 <a class="reference internal" href="#utime.ticks_cpu" title="utime.ticks_cpu"><code class="xref any py py-func docutils literal"><span class="pre">ticks_cpu()</span></code></a> 函数
（或先前调用的 <a class="reference internal" href="#utime.ticks_add" title="utime.ticks_add"><code class="xref any py py-func docutils literal"><span class="pre">ticks_add()</span></code></a> ）的直接结果。但是，delta可为一个任意整数或一个数字表达。 <a class="reference internal" href="#utime.ticks_add" title="utime.ticks_add"><code class="xref any py py-func docutils literal"><span class="pre">ticks_add()</span></code></a> 对计算事件/任务的截止时间非常有用。
（注意：您必须使用 <a class="reference internal" href="#utime.ticks_diff" title="utime.ticks_diff"><code class="xref any py py-func docutils literal"><span class="pre">ticks_diff()</span></code></a> 函数来处理截止时间。）</p>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Find out what ticks value there was 100ms ago 找到100ms前的ticks值</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ticks_add</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">ticks_ms</span><span class="p">(),</span> <span class="o">-</span><span class="mi">100</span><span class="p">))</span>

<span class="c1"># Calculate deadline for operation and test for it 计算操作和测试的截止时间</span>
<span class="n">deadline</span> <span class="o">=</span> <span class="n">ticks_add</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">ticks_ms</span><span class="p">(),</span> <span class="mi">200</span><span class="p">)</span>
<span class="k">while</span> <span class="n">ticks_diff</span><span class="p">(</span><span class="n">deadline</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">ticks_ms</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">do_a_little_of_something</span><span class="p">()</span>

<span class="c1"># Find out TICKS_MAX used by this port 找到该端口使用的TICKS_MAX</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ticks_add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utime.ticks_diff">
<code class="descclassname">utime.</code><code class="descname">ticks_diff</code><span class="sig-paren">(</span><em>ticks1</em>, <em>ticks2</em><span class="sig-paren">)</span><a class="headerlink" href="#utime.ticks_diff" title="永久链接至目标">¶</a></dt>
<dd><p>测量连续调用ticks_ms()、ticks_us()、icks_cpu()间的周期。
由这些函数返回的值可能在任何时间停止，因此并不支持直接减去这些值，应使用ticks_diff()。
“旧”值实际上应及时覆盖“新”值，否则结果将未定义。该函数不应用于测量任意周期长的时间（因为ticks_*()函数包括且通常有短周期）。
预期使用模式是使用超时实现事件轮询：</p>
<p>参数顺序与减法操作符相同， <code class="docutils literal"><span class="pre">ticks_diff(ticks1,&nbsp;ticks2)</span></code> 与 <code class="docutils literal"><span class="pre">ticks1&nbsp;-&nbsp;ticks2</span></code> 意义相同。
但是，函数可能会围绕由 <a class="reference internal" href="#utime.ticks_ms" title="utime.ticks_ms"><code class="xref any py py-func docutils literal"><span class="pre">ticks_ms()</span></code></a> 返回的值，因此在此使用减法将会产生错误结果。于是 <a class="reference internal" href="#utime.ticks_diff" title="utime.ticks_diff"><code class="xref any py py-func docutils literal"><span class="pre">ticks_diff()</span></code></a> 应运而生，
即使在环绕值情况下，它也能实现模块化（或者更确切地说，ring）算法生成正确值（只要它们之间的距离不太远，见下）。
该函数返回介于[ <em>-TICKS_PERIOD/2&nbsp;..TICKS_PERIOD/2-1</em> ]的有符号整数值（这是两个互补的二进制整数的典型范围定义）。
若该结果为负，则意味着 <em>ticks1</em> 发生在&nbsp;<em>ticks2</em> 之前。否则，则意味着 <em>ticks1</em> 发生在 <em>ticks2</em> 之后。
这只在距离彼此不超过 <em>TICKS_PERIOD/2-1</em> &nbsp;ticks时成立。若未成立，则将返回错误结果。特别地，
若两个tick值距离 <em>TICKS_PERIOD/2-1&nbsp;ticks</em> ，则该值将由此函数返回。但是，若在其之间传递实时ticks的 <em>TICKS_PERIOD/2</em> ，
该函数会返回 <em>TICKS_PERIOD/2</em> ，也就是说，结果值将会绕到可能值的负范围内。</p>
<p>上述限制的常用原理：假设您被锁在一个房间里，只有一个标准12级时钟来记录时间进程。若您现在看一下表，
并在接下来的13个小时中不再查看时间（例如您可能睡了很久），然后当您再次看表时，对您来说只过了1小时。
为避免这种错误，请定时查看时间。您的应用程序也应如此。“睡太久”的比喻直接影射应用程序的行为：
请勿让您的应用程序运行单一程序过久。按步骤运行任务，并在步骤进行时计时。</p>
<p><a class="reference internal" href="#utime.ticks_diff" title="utime.ticks_diff"><code class="xref any py py-func docutils literal"><span class="pre">ticks_diff()</span></code></a> 设计适用于各种使用模式，其中包括:</p>
<ul>
<li><p class="first">使用超时轮询。在此种情况下，事件顺序已知，您只需处理 <a class="reference internal" href="#utime.ticks_diff" title="utime.ticks_diff"><code class="xref any py py-func docutils literal"><span class="pre">ticks_diff()</span></code></a> 的正结果:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Wait for GPIO pin to be asserted, but at most 500us 等待GPIO注脚确认，单最多等待500us</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">ticks_us</span><span class="p">()</span>
<span class="k">while</span> <span class="n">pin</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">ticks_diff</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">ticks_us</span><span class="p">(),</span> <span class="n">start</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TimeoutError</span>
</pre></div>
</div>
</li>
<li><p class="first">安排事件。在此种情况下，若某一事件超期，则 <a class="reference internal" href="#utime.ticks_diff" title="utime.ticks_diff"><code class="xref any py py-func docutils literal"><span class="pre">ticks_diff()</span></code></a> 的结果可能为负:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># This code snippet is not optimized 这一代码片段没有经过优化</span>
<span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">ticks_ms</span><span class="p">()</span>
<span class="n">scheduled_time</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">scheduled_time</span><span class="p">()</span>
<span class="k">if</span> <span class="n">ticks_diff</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">scheduled_time</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Too early, let&#39;s nap&quot;</span><span class="p">)</span>
    <span class="n">sleep_ms</span><span class="p">(</span><span class="n">ticks_diff</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">scheduled_time</span><span class="p">))</span>
    <span class="n">task</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="k">elif</span> <span class="n">ticks_diff</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">scheduled_time</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Right at time!&quot;</span><span class="p">)</span>
    <span class="n">task</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="k">elif</span> <span class="n">ticks_diff</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">scheduled_time</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Oops, running late, tell task to run faster!&quot;</span><span class="p">)</span>
    <span class="n">task</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_faster</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>注意：请勿将 <a class="reference internal" href="#utime.time" title="utime.time"><code class="xref any py py-func docutils literal"><span class="pre">time()</span></code></a> 值传递给 <a class="reference internal" href="#utime.ticks_diff" title="utime.ticks_diff"><code class="xref any py py-func docutils literal"><span class="pre">ticks_diff()</span></code></a> ，您应在此使用正常的数学运算。但是请注意 <a class="reference internal" href="#utime.time" title="utime.time"><code class="xref any py py-func docutils literal"><span class="pre">time()</span></code></a> 可能（且将会）溢出。这被称为 <a class="reference external" href="https://en.wikipedia.org/wiki/Year_2038_problem">https://en.wikipedia.org/wiki/Year_2038_problem</a> .</p>
</dd></dl>

<dl class="function">
<dt id="utime.time">
<code class="descclassname">utime.</code><code class="descname">time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utime.time" title="永久链接至目标">¶</a></dt>
<dd><p>假设底层RTC是按照上述设置和维护的，则返回整数形式的秒钟数。若RTC未设定，该函数将返回一个特定于端口的引用点的秒数
（对无电池支持的RTC的嵌入式电路板而言，通常在电源启动或复位后）。若您想开发可移植的MicroPython应用程序，
您不应依赖该函数来提供高于第二精度的结果。若您需要更高精度，请使用 <code class="docutils literal"><span class="pre">ticks_ms()</span></code> 和 <code class="docutils literal"><span class="pre">ticks_us()</span></code> 函数。
若您需要日历时间，无参数的 <code class="docutils literal"><span class="pre">localtime()</span></code> 不失为佳选。</p>
<div class="attention admonition">
<p class="first admonition-title">Difference to CPython</p>
<p class="last">在CPython中，该函数返回自Unix时刻，即1970-01-01 00:00 UTC始的浮点数形式的秒数，
其精度通常可达微秒。使用MicroPython时，只有Unix端口使用相同时刻，若浮点精度允许，
则返回次秒级精度。嵌入式硬件通常不具有浮点精度，可表示长时间范围和次秒级秒精度，
因此它们使用具有第二精度的整数值。某些嵌入式硬件也缺乏电池供电的RTC，
因此，返回自上次接通电源后或其他相关的制定硬件点的秒数（例：重置）。</p>
</div>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="uzlib.html" class="btn btn-neutral float-right" title="uzlib – zlib解压缩" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ustruct.html" class="btn btn-neutral" title="ustruct – 打包和解压缩原始数据类型" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2017, Damien P. George, Paul Sokolovsky, 星瞳科技SingTown, and contributors.
      最后更新于 17 3月 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Ports and Versions</span>
    pyboard (latest)
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Ports</dt>
      
        <dd><a href="https://docs.singtown.com/micropython/zh/latest/pyboard/index.html">pyboard</a></dd>
      
        <dd><a href="https://docs.singtown.com/micropython/zh/latest/esp32/index.html">esp32</a></dd>
      
        <dd><a href="https://docs.singtown.com/micropython/zh/latest/openmvcam/index.html">openmvcam</a></dd>
      
    </dl>
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="https://docs.singtown.com/micropython/zh/latest/pyboard/index.html">latest</a></dd>
      
    </dl>
    <dl>
        <dt>Language</dt>
        
          <dd><a href="https://docs.micropython.org/en/latest/pyboard">English</a></dd>
        
          <dd><a href="https://docs.singtown.com/micropython/zh/latest/pyboard/index.html">中文</a></dd>
        
    </dl>

    <dl>
    </dl>
    <hr/>
    <dl>
      <dt>External links</dt>
        <dd>
          <a href="https://kaizhi-xu.taobao.com">立即购买 OpenMV Cam</a>
        </dd>
    </dl>
  </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.9.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
